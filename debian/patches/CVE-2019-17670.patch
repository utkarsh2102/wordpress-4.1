Description: CVE-2019-17670
 Patching server Side Request Forgery (SSRF) vulnerability 
---
Author: Abhijith PA <abhijith@debian.org>
Origin: https://github.com/WordPress/WordPress/commit/9db44754b9e4044690a6c32fd74b9d5fe26b07b2
Bug-Debian: https://bugs.debian.org/942459
Last-Update: 2019-10-30

--- wordpress-4.1.28+dfsg.orig/wp-includes/pluggable.php
+++ wordpress-4.1.28+dfsg/wp-includes/pluggable.php
@@ -1272,6 +1272,7 @@ function wp_validate_redirect($location,
 		$path = '';
 		if ( ! empty( $_SERVER['REQUEST_URI'] ) ) {
 			$path = dirname( parse_url( 'http://placeholder' . $_SERVER['REQUEST_URI'], PHP_URL_PATH ) . '?' );
+			$path = wp_normalize_path( $path );
 		}
 		$location = '/' . ltrim( $path . '/', '/' ) . $location;
 	}
